<div class="backup-container">
  <div class="backup-header">
    <h2>ğŸ“‚ Respaldo de Datos</h2>
    <p>Exporta e importa todos tus datos financieros</p>
  </div>

  <!-- Resumen de datos actuales -->
  <div class="data-summary">
    <h3>ğŸ“Š Datos actuales</h3>
    <div class="summary-grid">
      <div class="summary-item">
        <span class="summary-icon">ğŸ¦</span>
        <div class="summary-info">
          <div class="summary-count">{{ dataSummary().accounts }}</div>
          <div class="summary-label">Cuentas</div>
        </div>
      </div>
      <div class="summary-item">
        <span class="summary-icon">ğŸ’³</span>
        <div class="summary-info">
          <div class="summary-count">{{ dataSummary().transactions }}</div>
          <div class="summary-label">Transacciones</div>
        </div>
      </div>
      <div class="summary-item">
        <span class="summary-icon">ğŸ’°</span>
        <div class="summary-info">
          <div class="summary-count">{{ dataSummary().loans }}</div>
          <div class="summary-label">PrÃ©stamos</div>
        </div>
      </div>
      <div class="summary-item">
        <span class="summary-icon">ğŸ”„</span>
        <div class="summary-info">
          <div class="summary-count">{{ dataSummary().recurringTransactions }}</div>
          <div class="summary-label">Trans. Recurrentes</div>
        </div>
      </div>
    </div>
    
    @if (dataSummary().lastBackup) {
      <div class="last-backup">
        <span class="backup-icon">ğŸ•</span>
        Ãšltimo respaldo: {{ formatDate(dataSummary().lastBackup!) }}
      </div>
    }
  </div>

  <!-- SecciÃ³n de ExportaciÃ³n -->
  <div class="export-section">
    <h3>ğŸ“¤ Exportar Datos</h3>
    <p>Descarga un archivo con todos tus datos financieros para crear un respaldo o Transferenciair a otro dispositivo.</p>
    
    <button 
      class="btn-export" 
      (click)="exportData()"
      [disabled]="isExporting()"
      [class.loading]="isExporting()">
      
      @if (isExporting()) {
        <span class="loading-spinner"></span>
        Exportando...
      } @else {
        <span class="export-icon">ğŸ’¾</span>
        Descargar Respaldo
      }
    </button>

    @if (exportSuccess()) {
      <div class="success-message">
        âœ… Datos exportados exitosamente
      </div>
    }

    @if (exportError()) {
      <div class="error-message">
        âŒ {{ exportError() }}
      </div>
    }
  </div>

  <!-- SecciÃ³n de ImportaciÃ³n -->
  <div class="import-section">
    <h3>ğŸ“¥ Importar Datos</h3>
    <p><strong>âš ï¸ Advertencia:</strong> Importar datos reemplazarÃ¡ toda la informaciÃ³n actual. Se crearÃ¡ un respaldo automÃ¡tico antes de proceder.</p>

    <div class="file-input-container">
      <input 
        type="file" 
        accept=".json"
        (change)="onFileSelected($event)"
        #fileInput
        class="file-input"
        id="importFile">
      <label for="importFile" class="file-input-label">
        <span class="file-icon">ğŸ“</span>
        {{ selectedFile() ? selectedFile()!.name : 'Seleccionar archivo de respaldo' }}
      </label>
    </div>

    @if (selectedFile()) {
      <div class="file-info">
        <div class="file-details">
          <span class="file-name">ğŸ“„ {{ selectedFile()!.name }}</span>
          <span class="file-size">{{ formatFileSize(selectedFile()!.size) }}</span>
        </div>
        
        <button 
          class="btn-import" 
          (click)="importData()"
          [disabled]="isImporting()"
          [class.loading]="isImporting()">
          
          @if (isImporting()) {
            <span class="loading-spinner"></span>
            Importando...
          } @else {
            <span class="import-icon">ğŸ“¥</span>
            Importar Datos
          }
        </button>
      </div>
    }

    @if (importSuccess()) {
      <div class="success-message">
        âœ… Datos importados exitosamente. Â¡Recarga la pÃ¡gina para ver los cambios!
      </div>
    }

    @if (importError()) {
      <div class="error-message">
        âŒ {{ importError() }}
      </div>
    }
  </div>

  <!-- Zona de peligro -->
  <div class="danger-zone">
    <h3>âš ï¸ Zona de Peligro</h3>
    <p>Estas acciones son irreversibles.</p>
    
    <button 
      class="btn-danger" 
      (click)="showResetConfirm = !showResetConfirm">
      ğŸ—‘ï¸ Resetear todos los datos
    </button>

    @if (showResetConfirm) {
      <div class="reset-confirm">
        <p><strong>Â¿EstÃ¡s seguro?</strong> Esta acciÃ³n eliminarÃ¡ TODOS los datos permanentemente.</p>
        <div class="confirm-buttons">
          <button class="btn-confirm-reset" (click)="resetAllData()">
            SÃ­, eliminar todo
          </button>
          <button class="btn-cancel" (click)="showResetConfirm = false">
            Cancelar
          </button>
        </div>
      </div>
    }
  </div>
</div>
